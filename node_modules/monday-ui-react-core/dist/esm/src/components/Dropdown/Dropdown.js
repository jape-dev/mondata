import{slicedToArray as e,defineProperty as n,toConsumableArray as o}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as t,ComponentDefaultTestId as i}from"../../tests/testIds.js";import r from"classnames";import a,{forwardRef as s,useRef as l,useMemo as c,useState as u,useCallback as d}from"react";import p,{createFilter as m,components as O}from"react-select";import f from"react-select/async";import{noop as v}from"lodash-es";import{WindowedMenuList as g}from"react-windowed-select";import b from"./components/menu/menu.js";import j from"./components/DropdownIndicator/DropdownIndicator.js";import C from"./components/option/option.js";import M from"./components/singleValue/singleValue.js";import y from"./components/ClearIndicator/ClearIndicator.js";import h from"./components/MultiValueContainer/MultiValueContainer.js";import{DROPDOWN_CHIP_COLORS as w,DROPDOWN_MENU_PLACEMENT as S,DROPDOWN_MENU_POSITION as I,ADD_AUTO_HEIGHT_COMPONENTS as D,defaultCustomStyles as R,DROPDOWN_ID as P,DROPDOWN_MENU_ID as V,DROPDOWN_MENU_ARIA_LABEL as A}from"./DropdownConstants.js";import E,{customTheme as W}from"./Dropdown.styles.js";import z from"./components/Control/Control.js";import x from"./components/menu/menu.module.scss.js";import L from"./Dropdown.module.scss.js";import{withStaticProps as N}from"../../types/withStaticProps.js";import{SIZES as T}from"../../constants/sizes.js";var F=s((function(s,m){var w=s.className,S=s.optionWrapperClassName,I=s.singleValueWrapperClassName,N=s.dropdownMenuWrapperClassName,T=s.placeholder,B=void 0===T?"":T,k=s.disabled,H=void 0!==k&&k,K=s.readOnly,U=void 0!==K&&K,_=s.withReadOnlyStyle,q=s.onMenuOpen,G=void 0===q?v:q,J=s.onMenuClose,Q=void 0===J?v:J,X=s.onFocus,Y=void 0===X?v:X,Z=s.onBlur,$=void 0===Z?v:Z,ee=s.onChange,ne=void 0===ee?v:ee,oe=s.searchable,te=void 0===oe||oe,ie=s.options,re=void 0===ie?[]:ie,ae=s.defaultValue,se=s.value,le=s.noOptionsMessage,ce=s.openMenuOnFocus,ue=s.openMenuOnClick,de=s.clearable,pe=void 0===de||de,me=s.OptionRenderer,Oe=s.optionRenderer,fe=s.ValueRenderer,ve=s.valueRenderer,ge=s.menuRenderer,be=s.menuPlacement,je=void 0===be?F.menuPlacements.BOTTOM:be,Ce=s.rtl,Me=s.size,ye=void 0===Me?F.sizes.MEDIUM:Me,he=s.asyncOptions,we=s.cacheOptions,Se=s.defaultOptions,Ie=s.isVirtualized,De=s.menuPortalTarget,Re=s.extraStyles,Pe=void 0===Re?R:Re,Ve=s.maxMenuHeight,Ae=s.menuIsOpen,Ee=s.tabIndex,We=void 0===Ee?"0":Ee,ze=s.id,xe=void 0===ze?P:ze,Le=s.menuId,Ne=void 0===Le?V:Le,Te=s.menuAriaLabel,Fe=void 0===Te?A:Te,Be=s.autoFocus,ke=void 0!==Be&&Be,He=s.multi,Ke=void 0!==He&&He,Ue=s.multiline,_e=void 0!==Ue&&Ue,qe=s.onOptionRemove,Ge=s.onOptionSelect,Je=s.onClear,Qe=s.onInputChange,Xe=void 0===Qe?v:Qe,Ye=s.closeMenuOnSelect,Ze=void 0===Ye?!Ke:Ye,$e=s.closeMenuOnScroll,en=void 0!==$e&&$e,nn=s.withMandatoryDefaultOptions,on=void 0!==nn&&nn,tn=s.isOptionSelected,rn=s.insideOverflowContainer,an=void 0!==rn&&rn,sn=s.insideOverflowWithTransformContainer,ln=void 0!==sn&&sn,cn=s.tooltipContent,un=void 0===cn?"":cn,dn=s.onKeyDown,pn=void 0===dn?v:dn,mn=s.isLoading,On=void 0!==mn&&mn,fn=s.loadingMessage,vn=s.ariaLabel,gn=s.tabSelectsValue,bn=void 0===gn||gn,jn=s.popupsContainerSelector,Cn=s.filterOption,Mn=s.menuPosition,yn=void 0===Mn?F.menuPositions.ABSOLUTE:Mn,hn=s["data-testid"],wn=l(),Sn=De||jn&&document.querySelector(jn),In=c((function(){return ae?Array.isArray(ae)?ae.map((function(e){return Object.assign(Object.assign({},e),{isMandatory:!0})})):Object.assign(Object.assign({},ae),{isMandatory:!0}):ae}),[ae]),Dn=u(In||[]),Rn=e(Dn,2),Pn=Rn[1],Vn=Oe||me,An=ve||fe,En=!!se,Wn=null!=se?se:Rn[0],zn=c((function(){return Array.isArray(Wn)?Wn.reduce((function(e,o){return Object.assign(Object.assign({},e),n({},o.value,o))}),{}):{}}),[Wn]),xn=c((function(){return vn||"".concat(U?"Readonly ":""," ").concat(un," ").concat(Array.isArray(Wn)?"Selected: ".concat(Wn.map((function(e){return e.label})).join(", ")):"Select")}),[vn,U,Wn,un]),Ln=Ke?Wn:se,Nn=c((function(){var o=E({size:ye,rtl:Ce,insideOverflowContainer:an,controlRef:wn,insideOverflowWithTransformContainer:ln}),t=Pe(o),i=Object.entries(t).reduce((function(t,i){var r=e(i,2),a=r[0],s=r[1];return Object.assign(Object.assign({},t),n({},a,(function(e,n){var t=o[a],i=t?t(e,n):e;return s(i,n)})))}),{});if(Ke){_e&&D.forEach((function(e){var n=i[e];i[e]=function(e,o){return Object.assign(Object.assign({},n(e,o)),{height:"auto"})}}));var r=i.valueContainer;i.valueContainer=function(e,n){return Object.assign(Object.assign({},r(e,n)),{paddingLeft:6})}}return i}),[ye,Ce,an,ln,Pe,Ke,_e]),Tn=d((function(e){return a.createElement(b,Object.assign({},e,{id:Ne,ariaLabel:Fe,Renderer:ge,dropdownMenuWrapperClassName:N}))}),[N,ge,Ne,Fe]),Fn=d((function(e){return a.createElement(j,Object.assign({},e,{size:ye}))}),[ye]),Bn=d((function(e){return a.createElement(C,Object.assign({},e,{Renderer:Vn,optionWrapperClassName:S}))}),[Vn,S]),kn=d((function(e){return a.createElement(O.Input,Object.assign({},e,{"aria-label":"Dropdown input","aria-controls":Ne}))}),[Ne]),Hn=d((function(e){return a.createElement(M,Object.assign({},e,{readOnly:U,Renderer:An,selectedOption:Wn[0],singleValueWrapperClassName:I}))}),[An,U,Wn,I]),Kn=d((function(e){return a.createElement(y,Object.assign({},e,{size:ye}))}),[ye]),Un=c((function(){return function(e,n){qe&&qe(zn[e]);var o=Array.isArray(Wn)?Wn.filter((function(n){return n.value!==e})):Wn;ne&&ne(o,n),Pn(o)}}),[ne,qe,Wn,zn]),_n=c((function(){return{selectedOptions:Wn,onSelectedDelete:Un,isMultiline:_e,insideOverflowContainer:an,insideOverflowWithTransformContainer:ln,controlRef:wn,tooltipContent:un,popupsContainerSelector:jn}}),[Wn,Un,_e,an,ln,un,jn]),qn=he?f:p,Gn=Object.assign({},he&&Object.assign({loadOptions:he,cacheOptions:we},Se&&{defaultOptions:Se})),Jn=Object.assign(Object.assign({},!he&&{options:re}),Ke&&{isMulti:!0}),Qn=d((function(e){var n,o=e.target;return!(null===(n=null==o?void 0:o.parentElement)||void 0===n?void 0:n.classList.contains(x.dropdownMenuWrapper))&&(en||an||ln)}),[an,ln,en]);return a.createElement(qn,Object.assign({className:r(L.dropdown,w),selectProps:_n,components:Object.assign(Object.assign({DropdownIndicator:Fn,Menu:Tn,ClearIndicator:Kn,Input:kn,Option:Bn,Control:z,SingleValue:Hn},Ke&&{MultiValue:v,ValueContainer:h}),Ie&&{MenuList:g}),closeMenuOnScroll:Qn,size:ye,noOptionsMessage:le,placeholder:B,isDisabled:H,isClearable:!U&&pe,isSearchable:!U&&te,readOnly:U,withReadOnlyStyle:_,"aria-readonly":U,"aria-label":xn,"aria-details":un,"aria-expanded":!U&&Ae,"aria-haspopup":"listbox","aria-activedescendant":!0,role:"combobox",defaultValue:ae,value:Ln,onMenuOpen:G,onMenuClose:Q,onFocus:Y,onBlur:$,onChange:function(e,n){switch(ne&&ne(e,n),n.action){case"select-option":var t=Ke?n.option:e;Ge&&Ge(t),En||Pn([].concat(o(Wn),[t]));break;case"clear":Je&&Je(),En||Pn(on?In:[])}},onKeyDown:pn,onInputChange:Xe,openMenuOnFocus:ce,openMenuOnClick:ue,isRtl:Ce,styles:Nn,theme:W,maxMenuHeight:Ve,menuPortalTarget:Sn,menuPlacement:je,menuPosition:yn,menuIsOpen:!U&&Ae,tabIndex:We,id:xe,"data-testid":hn||t(i.DROPDOWN,xe),autoFocus:ke,closeMenuOnSelect:Ze,ref:m,withMandatoryDefaultOptions:on,isOptionSelected:tn,isLoading:On,loadingMessage:fn,tabSelectsValue:bn,filterOption:Cn},Gn,Jn))})),B=N(F,{size:T,sizes:T,chipColors:w,menuPlacements:S,menuPositions:I,createFilter:m});export{B as default};
//# sourceMappingURL=Dropdown.js.map
